<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
  <meta charset="UTF-8">
  <title>{{ t['favorite_title'] }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <header>
    <h2>{{ t['favorite_title'] }}</h2>
    <div class="header-actions">
      <a href="{{ url_for('index') }}" class="add-button">{{ t['back_to_list'] }}</a>
    </div>
  </header>

  <div class="layout">
    <div class="sidebar">
      <!-- サイドバーそのままでOK -->
    </div>

    <section id="phrases">
      {% if phrases %}
        {% for p in phrases %}
          <div class="phrase-card">
            <form action="{{ url_for('delete_phrase', id=p.id) }}" method="POST" class="delete-form">
              <button type="submit" class="btn-delete" onclick="return confirm('{{ t['confirm_delete'] }}')">
                <!-- ✕ アイコン省略 -->
              </button>
            </form>

            <form action="{{ url_for('toggle_favorite', phrase_id=p.id) }}" method="POST">
              <button type="button"
                      class="fav-btn {{ 'filled' if p.is_favorite else 'outline' }}"
                      data-id="{{ p.id }}" data-fav="{{ 'true' if p.is_favorite else 'false' }}"
                      aria-label="お気に入り切り替え">
                <svg viewBox="0 0 24 24">
                  <path d="M12 .587l3.668 7.568L24 9.423l-6 5.847L19.335 24
                           12 19.77 4.665 24 6 15.27 0 9.423l8.332-1.268z"/>
                </svg>
              </button>
            </form>

            <div class="category
              {% if p.category == '挨拶' %}category-greeting
              {% elif p.category == '案内' %}category-guide
              {% elif p.category == '支払い' %}category-payment
              {% elif p.category == 'お礼' %}category-thanks
              {% else %}category-other{% endif %}">
              {{ p.category }}
            </div>

            <div class="text-line">{{ p.jp }}</div>
            <div class="text-line">{{ p.en }}</div>
            <div class="text-line">{{ p.ne }}</div>

            {% if p.audio_filename %}
              <audio controls src="{{ url_for('static', filename='audio/' + p.audio_filename) }}"></audio>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <p>{{ t['no_favorite'] }}</p>
      {% endif %}
    </section>
  </div>

  <script src="{{ url_for('static', filename='js/favorite.js') }}"></script>
</body>
</html>
